Ejercicio tipo Examen


			Se tienen los datos de un trabajador, cuyos datos son nombre, paterno y telefono.

			El trabajador tiene un sueldo base de 4,000 y se le desea hacer depositos de 4,000
			considerando las horas extras, cada hora extra se paga a 80 pesos.

				1) Aplicar la normalización a este problema

CREATE TABLE EMPLEADOS(
  ID_EMPLEADO INTEGER,
  NOMBRE VARCHAR2(180),
  APELLIDO VARCHAR2(180),
  TELEFONO INTEGER,
  CONSTRAINT ID_EMPLEADO_PK PRIMARY KEY (ID_EMPLEADO));
  
CREATE TABLE NOMINA(
  ID_NOMINA INTEGER,
  ID_EMPLEADO INTEGER,
  SUELDO_BASE FLOAT,
  HORAS_EXTRAS FLOAT,
  CONSTRAINT ID_NOMINA_PK PRIMARY KEY (ID_NOMINA),
  CONSTRAINT ID_EMPLEADO_FK FOREIGN KEY (ID_EMPLEADO) REFERENCES EMPLEADOS (ID_EMPLEADO));



				2) Crear un procedimiento para pagar la nomina, considerando el id del trabajador 
  				   y las horas extras

CREATE SEQUENCE SEC_EMPLEADOS
START WITH 1
INCREMENT BY 1
NOMAXVALUE;

CREATE SEQUENCE SEC_NOMINA
START WITH 1
INCREMENT BY 1
NOMAXVALUE;

CREATE OR REPLACE PROCEDURE GUARDAR_EMPLEADO(
MY_ID_EMPLEADO OUT INTEGER,
MY_NOMBRE IN VARCHAR2,
MY_APELLIDO IN VARCHAR2,
MY_TELEFONO IN INTEGER)
AS
BEGIN
SELECT SEC_EMPLEADOS.NEXTVAL INTO MY_ID_EMPLEADO FROM DUAL;
INSERT INTO EMPLEADOS VALUES (MY_ID_EMPLEADO, MY_NOMBRE, MY_APELLIDO, MY_TELEFONO);
END;
/

CREATE OR REPLACE PROCEDURE GENERAR_NOMINA(
MY_NOMBRE IN VARCHAR2,
MY_APELLIDO IN VARCHAR2,
MY_TELEFONO IN INTEGER,
MY_ID_NOMINA OUT INTEGER,
MY_SUELDO_BASE IN FLOAT,
MY_HORAS_EXTRAS IN FLOAT)
AS
VALOR_ID_EMPLEADO INTEGER;
BEGIN
GUARDAR_EMPLEADO(VALOR_ID_EMPLEADO, MY_NOMBRE, MY_APELLIDO, MY_TELEFONO);
SELECT SEC_NOMINA.NEXTVAL INTO MY_ID_NOMINA FROM DUAL;
INSERT INTO NOMINA VALUES(MY_ID_NOMINA, VALOR_ID_EMPLEADO, MY_ID_SUELDO_BASE, MY_HORAS_EXTRAS);
END;
/

DECLARE
VALOR INTEGER;
BEGIN
GENERAR_NOMINA('nombre','apellido','telefono',VALOR,sueldo,horasextras);
END;
/

SELECT * FROM EMPLEADOS;
SELECT * FROM NOMINA;


				3) Crear un disparador que impida que se realice un deposito que no sea en los días 28
